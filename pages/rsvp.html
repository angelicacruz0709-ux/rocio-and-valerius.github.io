<!DOCTYPE html>

<html lang="de-DE">
  <head>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="/css/index.css" />
    <link rel="stylesheet" href="/css/rsvp.css" />
    <script>
      $(function () {
        $("head").append("/head.html");
      });
    </script>
  </head>

  <body>
    <header>
      <div id="logo"></div>
      <script src="../js/countdown.js"></script>
      <nav></nav>
    </header>

    <main>
      <article class="section">
        <section>
          <h3>RSPV</h3>
          <form id="rsvp">
            <input
              type="text"
              name="name"
              placeholder="Dein Name"
              required
            /><br />
            <select id="event" name="event" required>
              <option value="" disabled selected hidden>Wähle ein Event</option>
              <option value="231125">
                23. November 2025, "Weber's Esszeit", Gutach, Deutschland
              </option>
              <option value="040426">
                4. April 2026, "El Convento", Mexiko-Stadt, Mexiko
              </option>
            </select>
            <br />
            <select id="response" name="response" required>
              <option value="" disabled selected hidden>Teilnahme?</option>
              <option value="Ja">Ja</option>
              <option value="Nein">Nein</option>
            </select>
            <br />
            <input
              type="number"
              name="count"
              placeholder="Anzahl Personen"
              min="0"
              max="6"
            /><br />
            <textarea
              name="other"
              rows="5"
              cols="20"
              placeholder="Möchtest Du uns sonst noch etwas mitteilen?"
            ></textarea>
            <br />
            <input
              type="text"
              name="invite_code"
              placeholder="Einladungscode"
              required
            /><br />
            <button type="submit">
              <i class="fas fa-envelope"></i> Absenden
            </button>
          </form>

          <p id="status"></p>

          <script>
            $("#rsvp").on("submit", function (e) {
              e.preventDefault();
              var data = $(this).serialize();

              $("#status").text("Submitting...");

              $.post(
                "https://script.google.com/macros/s/AKfycbyRxN1Vx-_m1LIPYEzxsZAyWd772cc6xxNoOZg38vZYPe8zvQicJ4XeAQfdAXjO03SmSw/exec",
                data,
                null,
                "json"
              )
                .done(function (res) {
                  if (res.result === "success") {
                    $("#status").text(
                      "Thank you! Your RSVP has been recorded."
                    );
                    $("#rsvp")[0].reset();
                  } else {
                    $("#status").text("Error: " + res.message);
                  }
                })
                .fail(function (err) {
                  console.error(err);
                  $("#status").text("Could not connect to server.");
                });
            });
          </script>
        </section>
      </article>

      <script>
        const eventSelect = document.getElementById("event");

        eventSelect.addEventListener("change", function () {
          this.classList.add("selected");
        });
        const responseSelect = document.getElementById("response");

        responseSelect.addEventListener("change", function () {
          this.classList.add("selected");
        });
      </script>
    </main>

    <footer></footer>

    <script>
      fetch("/logo.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("logo").innerHTML = data;
        });
    </script>

    <script>
      $(function () {
        $("nav").load("/nav.html");
        $("footer").load("/footer.html");
      });
    </script>
  </body>
</html>
